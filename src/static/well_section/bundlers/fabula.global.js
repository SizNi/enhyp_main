(()=>{function e(e,t,a,r){Object.defineProperty(e,t,{get:a,set:r,enumerable:!0,configurable:!0})}function t(e){Object.defineProperty(e,"__esModule",{value:!0,configurable:!0})}var a=globalThis,r={},s={},o=a.parcelRequireda87;null==o&&((o=function(e){if(e in r)return r[e].exports;if(e in s){var t=s[e];delete s[e];var a={id:e,exports:{}};return r[e]=a,t.call(a.exports,a,a.exports),a.exports}var o=Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}).register=function(e,t){s[e]=t},a.parcelRequireda87=o);var n=o.register;n("juxiN",function(t,a){e(t.exports,"register",()=>r,e=>r=e),e(t.exports,"resolve",()=>s,e=>s=e);var r,s,o=new Map;r=function(e,t){for(var a=0;a<t.length-1;a+=2)o.set(t[a],{baseUrl:e,path:t[a+1]})},s=function(e){var t=o.get(e);if(null==t)throw Error("Could not resolve bundle with id "+e);return new URL(t.path,t.baseUrl).toString()}}),n("4qOVI",function(t,a){e(t.exports,"getBundleURL",()=>r,e=>r=e);var r,s={};r=function(e){var t=s[e];return t||(t=function(){try{throw Error()}catch(t){var e=(""+t.stack).match(/(https?|file|ftp|(chrome|moz|safari-web)-extension):\/\/[^)\n]+/g);if(e)// Use the 3rd one, which will be a runtime in the original bundle.
return(""+e[2]).replace(/^((?:https?|file|ftp|(chrome|moz|safari-web)-extension):\/\/.+)\/[^/]+$/,"$1")+"/"}return"/"}(),s[e]=t),t}}),n("9edIi",function(t,a){e(t.exports,"default",()=>i);var r=o("eVNf3"),s=o("7ZQJ3"),n=o("28Rvf"),i={template:`
    <div class="fblDialog"></div>
    <div class="fblNotify" popover="manual"></div>
    <div class="fblForm l-container l-content">
        <div class="fblBreadcrumbs"></div>
        <div class="fblContent"></div>
        <div class="fblBtns l-fx l-gap"></div>
    </div>`,sources:{dialog:()=>o("c50q7")},props:{},params:{buttons:[]},proxies:{message:"",loaded:!1,index:null},handlers:{async index(e){4===this.phase&&this.method.navigate(this.param.target.breadcrumbs.navigate[e]);// this.method.updateGroup({ value: {}, index: v })
// await this.mount({
//   src: block,
//   container: this.node.fblContent,
//   params: { name: this.param.name, target: this.param.target.children[v], path: [] }
// })
}},nodes(){return{fblDialog:{},fblNotify:{onclick:e=>e.target.hidePopover()},fblBreadcrumbs:{component:{induce:()=>this.param.target.breadcrumbs,src:n.default,proxies:{value:this.param.target.breadcrumbs?.current},params:{size:"large",options:{buttons:this.param.target.breadcrumbs?.navigate}},methods:{change:(e,t)=>this.proxy.index=t}}},fblForm:{hidden:()=>!this.proxy.loaded},fblContent:{component:{src:r.default,params:{name:this.param.name,target:this.param.target,path:[]}}},fblBtns:{component:{src:s.default,iterate:()=>this.param.buttons,params:{size:"large",name:e=>e.name,type:e=>e.type,options:e=>e},proxies:{value:e=>e.text,disabled:e=>this.proxy.error&&e.validation},methods:{action:async e=>{let t=this.param.buttons.findIndex(t=>t.name===e);this.node.fblBtns.children[t].method.spinner(!0);let a=await this.method.button({name:e});this.node.fblBtns.children[t].method.spinner(!1),this.method.notify(a)}}}}}},methods:{async notify(e){e&&(this.node.fblNotify.textContent=e.message||"...",this.node.fblNotify.setAttribute("type",e.type||"warning"),this.node.fblNotify.showPopover(),await this.delay(e.delay||2500),this.node.fblNotify.hidePopover())}},loaded(){let e=this.options.inputs;this.options.props={params:{name:{},target:{store:e.params.name}},proxies:{_values:{store:e.params.name},breadcrumbs:{store:e.params.name},error:{store:e.params.name}},methods:{button:{store:e.params.name},action:{store:e.params.name},navigate:{}}}},created(){let e=this.fabula[this.param.name].model.mode?.name;this.param.buttons=e?this.param.target.buttons?.filter(t=>t.modeName?t.modeName===e:t):this.param.target.buttons},async mounted(){let e=this.fabula[this.param.name];e.dialog=async(t,a)=>{let r=e.model.dialogs?.find(e=>e.name===t),s=this.node.fblDialog;r&&await this.mount({container:s,src:this.source.dialog,params:{title:r.title,text:a||r.text,allow:r.allow,reject:r.reject},proxies:{opened:!0},methods:{onclose:()=>{this.node.fblDialog.unmount()},allow:async()=>{let e=await this.method.action({name:r.name});this.method.notify(e)}}})},this.proxy.loaded=!0}}}),n("eVNf3",function(t,a){e(t.exports,"default",()=>r);var r={template:'<div><div class="fblBlock"></div></div>',sources:{collection:()=>o("aQ6aG"),standard:()=>o("l7P40")},props:{params:{name:{},target:{},path:{}}},nodes(){return{fblBlock:{component:{src:this.source[this.method.define()],params:{name:this.param.name,target:this.param.target,path:[...this.param.path,this.param.target.name]}}}}},methods:{define(){let e=this.param.target;return e.collection?"collection":"standard"}}}}),n("aQ6aG",function(e,t){e.exports=Promise.all([o("cPcr1")(o("juxiN").resolve("9icF0")),o("hK9Md")(o("juxiN").resolve("6NJ0N"))]).then(()=>o("gmyca"))}),n("cPcr1",function(e,t){var a=o("3AMmx");e.exports=a(function(e){return new Promise(function(t,a){if([].concat(document.getElementsByTagName("link")).some(function(t){return t.href===e&&t.rel.indexOf("stylesheet")>-1})){t();return}var r=document.createElement("link");r.rel="stylesheet",r.href=e,r.onerror=function(e){r.onerror=r.onload=null,r.remove(),a(e)},r.onload=function(){r.onerror=r.onload=null,t()},document.getElementsByTagName("head")[0].appendChild(r)})})}),n("3AMmx",function(e,t){var a={},r={},s={};e.exports=function(e,t){return function(o){var n=function(e){switch(e){case"preload":return r;case"prefetch":return s;default:return a}}(t);return n[o]?n[o]:n[o]=e.apply(null,arguments).catch(function(e){throw delete n[o],e})}}}),n("hK9Md",function(e,t){var a=o("3AMmx");e.exports=a(function(e){return new Promise(function(t,a){if([].concat(document.getElementsByTagName("script")).some(function(t){return t.src===e})){t();return}var r=document.createElement("link");r.href=e,r.rel="preload",r.as="script",document.head.appendChild(r);var s=document.createElement("script");s.async=!0,s.type="text/javascript",s.src=e,s.onerror=function(t){var r=TypeError("Failed to fetch dynamically imported module: ".concat(e,". Error: ").concat(t.message));s.onerror=s.onload=null,s.remove(),a(r)},s.onload=function(){s.onerror=s.onload=null,t()},document.getElementsByTagName("head")[0].appendChild(s)})})}),n("l7P40",function(e,t){e.exports=Promise.all([o("cPcr1")(o("juxiN").resolve("9icF0")),o("hK9Md")(o("juxiN").resolve("cJk2F"))]).then(()=>o("77gqy"))}),n("7ZQJ3",function(a,r){t(a.exports),e(a.exports,"default",()=>s);var s={template:`
  <button class="lstBtn l-fx-b l-br">
    <span class="lstBtnIcon l-fx l-jc-center"></span>
    <span class="lstBtnText"></span>
  </button>`,directives:{_attr:o("1L9sq")._attr},props:{proxies:{value:{},disabled:{},error:{}},params:{name:{default:""},type:{default:"button"},size:{default:"medium"},text:{},options:{default:{}}},methods:{action:{}}},nodes(){return{lstBtn:{_class:{"l-fx-rev":"end"===this.param.options.iconPosition},_attr:{size:this.param.size},name:this.param.name,type:this.param.type,disabled:()=>this.proxy.disabled,onclick:()=>this.method.action?.(this.param.name)},lstBtnIcon:{_class:{lstSpinner:()=>this.proxy.error},_html:()=>this.param.options.icon},lstBtnText:{_text:()=>this.param.text??this.proxy.value}}},methods:{spinner(e){this.proxy.error=e}}}}),n("1L9sq",function(t,a){e(t.exports,"_attr",()=>r);let r={update:(e,t,a)=>{let r="function"==typeof t[a]?t[a]():t[a];"boolean"==typeof r?r?e.setAttribute(a,""):e.removeAttribute(a):r&&e.setAttribute(a,r)}}}),n("28Rvf",function(a,r){t(a.exports),e(a.exports,"default",()=>s);var s={template:'<div class="lstLbl l-label"></div><fieldset class="lstBtns l-fx"></fieldset>',props:{proxies:{value:{},disabled:{},error:{}},params:{size:{default:"small"},name:{default:""},type:{type:"string"},text:{},options:{default:{}}},methods:{change:{}}},nodes(){return{lstLbl:{_text:()=>this.param.text},lstBtns:{name:this.param.name,_class:{"l-radio":"radio"===this.param.type},_html:()=>this.method.render(),onclick:e=>{if(e.target.closest(".lstBtns > button")){let t=+e.target.dataset.index,a=this.param.options.buttons||this.proxy.value;this.method.change&&this.method.change(a[t],t)}}}}},methods:{render(){let e=this.param.options.buttons||this.proxy.value,t=e=>Array.isArray(this.proxy.value)?this.proxy.value.includes(e):this.proxy.value===e;return e?.reduce((e,a,r)=>e+`
        <button class="${t(a)?"l-active":""}" data-index="${r}" size="${this.param.size}">${a}</button>`,"")},update(e){this.proxy.value=e}}}}),n("c50q7",function(e,t){e.exports=Promise.all([o("cPcr1")(o("juxiN").resolve("9excu")),o("hK9Md")(o("juxiN").resolve("7S61A"))]).then(()=>o("bCUam"))}),n("9W4Qi",function(e,t){e.exports=Promise.all([o("cPcr1")(o("juxiN").resolve("2opX6")),o("hK9Md")(o("juxiN").resolve("7OU1a"))]).then(()=>o("6P2Mg"))}),n("fBjj3",function(e,t){e.exports=Promise.all([o("cPcr1")(o("juxiN").resolve("gu83a")),o("hK9Md")(o("juxiN").resolve("btF7u"))]).then(()=>o("5c6D4"))}),n("ehMpB",function(e,t){e.exports=Promise.all([o("cPcr1")(o("juxiN").resolve("70amL")),o("hK9Md")(o("juxiN").resolve("7SAYU"))]).then(()=>o("5AZtM"))}),n("2xmp7",function(e,t){e.exports=Promise.all([o("cPcr1")(o("juxiN").resolve("bxNsX")),o("hK9Md")(o("juxiN").resolve("l2ZhD"))]).then(()=>o("bAWIf"))}),n("iAcTm",function(e,t){e.exports=Promise.all([o("cPcr1")(o("juxiN").resolve("gMChp")),o("hK9Md")(o("juxiN").resolve("3AbxS"))]).then(()=>o("5DlNz"))}),n("lVcXt",function(e,t){e.exports=o("hK9Md")(o("juxiN").resolve("hQIoX")).then(()=>o("hrWk8"))}),o("juxiN").register(o("4qOVI").getBundleURL("5JBrp"),JSON.parse('["5JBrp","fabula.global.js","6NJ0N","collection.c4bf35f6.js","9icF0","collection.f8405f43.css","cJk2F","standard.717e3602.js","7S61A","dialog.9f8cb5f9.js","9excu","dialog.f1f525f5.css","7OU1a","input.f3875200.js","8BOUN","info.37b7dd53.js","aRuG6","info.6c054099.css","2opX6","input.125c7d67.css","btF7u","nest.0ea8c739.js","gu83a","nest.7b65e92d.css","7SAYU","dropList.d8ca88fe.js","70amL","dropList.79651a61.css","l2ZhD","text.5ffa9e98.js","bxNsX","text.7e35a356.css","3AbxS","checkbox.8926c77f.js","gMChp","checkbox.48c41394.css","hQIoX","group.645c36ec.js","7ffzS","fabula.global.css"]'));var i=o("9edIi"),l={input:()=>o("9W4Qi"),button:()=>Promise.resolve(o("7ZQJ3")),buttons:()=>Promise.resolve(o("28Rvf")),nest:()=>o("fBjj3"),dropList:()=>o("ehMpB"),text:()=>o("2xmp7"),checkbox:()=>o("iAcTm")};window.fabula={install(e){let t={group:()=>o("lVcXt")};e.fabula={},e.elements=l,e.mountForm=async({name:a,container:r,options:s})=>{var o;e.fabula[a]={name:a,model:null,dialog:null,method:{},breadcrumbs:[]};let n=s.data?await s.data():{};e.fabula[a].model=await s.model(),e.store.destroy(a),e.stores[a]={params:{target:(o=e.fabula[a]).model,errors:{},values:{}},proxies:{_values:{},error:!0},setters:{...s.setters},methods:{get({path:e}){this.deliver(this.proxy._values,e)},set({path:e,value:t}){this.deliver(this.proxy._values,e,t)},add({target:e,path:t}){let a=this.deliver(this.proxy._values,t)?.length||0;this.method.form({target:e,path:[...t,a]}),this.deliver(this.proxy._values,[...t,"length"],a+1)},remove({path:e}){let t=this.deliver(this.proxy._values,e)?.length||0;this.deliver(this.proxy._values,[...e,"length"],t-1)},error({key:e,value:t}){this.param.errors[e]=t,this.proxy.error=Object.values(this.param.errors).includes(!0)},update({values:e}){this.param.values=e,this.param.error={},this.proxy.error=!0,this.method.forms({target:this.param.target,path:[]}),console.log(this.proxy._values)},updateGroup({values:e,index:t}){this.param.values=e,(this.param.target.elements||this.param.target.collection)&&console.warn("group error");let a=this.param.target.children[t];this.method.form({target:a,path:[a.name]}),this.param.error={},this.proxy.error=!0,console.log(this.proxy._values)},async button({name:e}){return await s.buttons[e]?.bind(o)(this.replicate(this.proxy._values),this.proxy.error)},action:async({name:e,value:t})=>await s.actions[e]?.bind(o)(t),form({target:e,path:t}){this.deliver(this.proxy._values,t)||this.deliver(this.proxy._values,t,{}),e.elements?.forEach(e=>{let a=[...t,e.name],r=this.deliver(this.param.values,a);this.deliver(this.proxy._values,a,r??e.value??e.default??null)}),e.children?.forEach(e=>this.method.forms({target:e,path:t}))},forms({target:e,path:t}){if(t=[...t,e.name],e.collection){let a=e.collection.minlength,r=this.deliver(this.param.values,t);this.deliver(this.proxy._values,t)||this.deliver(this.proxy._values,t,[]);for(let s=0;s<(r?.length??a);s++)this.method.form({target:e,path:[...t,s]});// const length = this.deliver(this.proxy._values, path)?.length || 0
this.deliver(this.proxy._values,[...t,"length"],r?.length??a)}else this.method.form({target:e,path:t})}},async created(){let{get:e,set:t,add:a,remove:r,update:s}=this.method;o.method={get:e,set:t,add:a,remove:r,update:s},this.param.target.group?this.method.updateGroup({values:n,index:this.param.target.group.startIndex}):this.method.update({values:n})}};let l=e.fabula[a].model.group?await e.loadModule(t.group):i.default;await e.mount({container:r,src:l,params:{name:a}})},e.execute=({_values:t,path:a,value:r,direction:s,exclude:o})=>{let n,i;let l=[...a];"number"==typeof l.at(-1)&&(n=l.pop(),l.push("length"),i=o(()=>e.deliver(t,l)));let d={};a.forEach((e,t)=>"number"==typeof e&&(d[a[t-1]]=e));let c=Function("_values","value","index","length","currentIndex","fieldData","return "+s);return c(t,r,n,i,d)}}}})();